!function(){"use strict";function t(t,n,e){return{restrict:"E",replace:!0,scope:{data:"=",cols:"=",width:"=",actions:"=",hide:"=",subgrid:"=",template:"=",sgControls:"=",sgMenu:"=",fullscreen:"="},templateUrl:"softgrid.html",link:function(a,s,o){function l(){a.totalPages=a.data.length/a.sg_linesPerPage,a.totalPages=a.totalPages>parseInt(a.totalPages)?parseInt(a.totalPages)+1:a.totalPages,a.soft_pages=[],a.soft_pages.push({text:"<span class='fa fa-chevron-left'></span>",value:-1,active:!1}),a.totalPages>1&&a.soft_pages.push({text:"1..",value:1,active:1==a.sg_currentPage});for(var t=a.sg_currentPage,n=2;n<a.totalPages;n++){var e=n==t;(n<t+3||t<=3&&n<=6)&&(t>=3&&n>t-3||t<=3&&n<=5||t>=3&&n>=t&&n<=t-3||t>=a.totalPages-3&&n>=a.totalPages-5||t<=3&&n<=6)&&a.soft_pages.push({text:n,value:n,active:e})}a.soft_pages.push({text:".."+a.totalPages,value:a.totalPages,active:a.sg_currentPage==a.totalPages}),a.soft_pages.push({text:"<span class='fa fa-chevron-right'></span>",value:0,active:!1})}function r(t){var n='<table border="3" cellpadding="3" cellspacing="3"><tbody>';return t.forEach(function(t){var e="<tr>";t.forEach(function(t){e+=t?'<td style="color:'+t.corFonte+";background-color:"+t.corFundo+";font-weight:"+t.grossuraFonte+'; ">'+t.valor+"</td>":"<td></td>"}),n+=e+="</tr>"}),n+="</tbody></table>"}function i(t,n,e,a,s,o,l){var i=[];return i=i.concat(function(t,n,e){var a=[],s=new Array(n);return t.forEach(function(t){s[e]={valor:t.title,corFundo:"#FA6938",corFonte:"#FFFFFF",grossuraFonte:800},e++}),a.push(s),a}(t,o,s)),i=i.concat(function(t,n,e,a,s,o){var l=[];return a.forEach(function(n){var e=new Array(s),a=o;t.forEach(function(t){e[a]={valor:function(t,n){var e="";return t&&(e=angular.isFunction(n.item)?n.item(t):t[n.propriedade]),e||(e=" - "),e}(n,t),corFundo:"#FFFFFF",corFonte:"#000000",grossuraFonte:100},a++}),l.push(e)}),l}(t,0,0,n,o,s)),l?r(i):i}function g(){a.larguraColunaAcoes=0,a.subgrid&&(a.larguraColunaAcoes+=60),a.actions&&a.actions.length>0&&(a.larguraColunaAcoes+=60)}a.sg_currentPage=1,a.sg_linesPerPageInput=10,a.sg_linesPerPage=10,a.sg_orderBy="",a.sg_filterSearch="",a.larguraColunaControles=0;var c=!1;a.sg_changePage=function(t){-1==t&&a.sg_currentPage>1?a.sg_currentPage=a.sg_currentPage-1:-1==t&&1==a.sg_currentPage?a.sg_currentPage=a.totalPages:0==t&&a.sg_currentPage==a.totalPages?a.sg_currentPage=1:0==t&&a.sg_currentPage<a.totalPages?a.sg_currentPage=a.sg_currentPage+1:a.sg_currentPage=t,l()},a.sg_changeLinesPerPage=function(t){(-1==t&&a.sg_linesPerPageInput>10||1==t)&&(a.sg_linesPerPageInput=a.sg_linesPerPageInput+10*t)},a.sg_sort=function(n){a.data.length>0&&(a.reverse=null!==a.sg_orderBy&&a.sg_orderBy===n.item&&!a.reverse,a.data=t("orderBy")(a.data,n.item,a.reverse),a.sg_orderBy=a.sgControls.orderBy=n.item,a.sg_orderByCol=n,c=!0)},a.sg_mask=function(t,n){return"phone"==t?function(t){return t=t.replace(/\D/g,""),t=t.replace(/^(\d{2})(\d)/g,"($1) $2"),t=t.replace(/(\d)(\d{4})$/,"$1-$2")}(n):"mail"==t?function(t){return"<a href='mailto:"+t+"'><span class='fa fa-envelope-o'></span> "+t+"</a>"}(n):n},a.sg_hook=function(){l(),$(".softgrid-container .dropdown").on("click",function(){var t=$(this),n=t.offset().top,e=$(this).height(),a=t.find(".dropdown-menu"),s=$(this).find(".btn").offset().left,o=$(window).scrollTop();a.css("top",n+e-o),a.css("left",s)}),$(window).scroll(function(){var t=$(".softgrid .dropdown.open");if(t.length>0){var n=t.find(".dropdown-menu"),e=$(this).scrollTop();n.css("top",t.offset().top+t.height()-e)}})},a.softGridToExcel=function(){!function(t){var e="data:application/vnd.ms-excel;base64,"+n.encode(t),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download",(new Date).toLocaleString()),document.body.appendChild(a),a.click(),document.body.removeChild(a)}(r(i(a.cols,a.data,0,0,0,a.cols.length)))},a.redimensionandoColuna=!1,a.elementoRedimensionado=void 0,a.posicaoElementoX=0,a.larguraElementoX=0,a.sg_edit=function(t,n,e,a){t[n.edit.item]=e,a.editing=!1,n.edit.function(t)},a.sg_openEdit=function(t,n){if(t.col.edit){t.editing=!t.editing;var a=angular.element(n.target).parent().parent().children()[0];e(function(){""!==a.value?a.select():a.focus()},200)}},e(function(){$(".softgrid th").mousedown(function(t){a.elementoRedimensionado=$(this),a.redimensionandoColuna=!0,a.posicaoElementoX=t.pageX,a.larguraElementoX=$(this).width()}),$(document).mousemove(function(t){a.redimensionandoColuna&&$(a.elementoRedimensionado).width(a.larguraElementoX+(t.pageX-a.posicaoElementoX))}),$(document).mouseup(function(){a.redimensionandoColuna&&(a.redimensionandoColuna=!1,a.$apply())})},500),a.$watch("data",function(){c?c=!1:a.sgControls&&angular.isDefined(a.sgControls.orderBy)&&a.sg_sort({item:a.sgControls.orderBy})}),a.$watch("sg_linesPerPageInput",function(){a.sg_linesPerPageInput>0&&(a.sg_linesPerPage=parseInt(a.sg_linesPerPageInput))}),a.$watch("sgControls",function(){angular.isDefined(a.sgControls)&&a.sgControls&&(a.sgControls.create&&(a.larguraColunaControles+=60),a.sgControls.read&&(a.larguraColunaControles+=60),a.sgControls.update&&(a.larguraColunaControles+=60),a.sgControls.delete&&(a.larguraColunaControles+=60))}),a.$watch("hide",function(){a.hide&&(1!=a.hide.pagination&&1!=a.hide.all||(a.sg_linesPerPage=999))}),a.$watch("subgrid",g),a.$watch("actions",g)}}}angular.module("softgrid.directive",["base64"]).directive("softgrid",t),t.$injector=["$filter","$base64","$timeout"]}(),angular.module("softgrid.directive").run(["$templateCache",function(t){t.put("softgrid.html",'\n<div class="softgrid-display" ng-class="{\'softgrid-display-fullscreen\': softgrid.fullscreen}" ng-style="sgControls.fullscreen && softgrid.fullscreen ? { \'z-index\': sgControls.fullscreen.zindex, \'top\': sgControls.fullscreen.top + \'px\'} : \'\'">\n\n    <div class="grid-controles" ng-style="sgControls.fullscreen && softgrid.fullscreen ? { \'z-index\': (sgControls.fullscreen.zindex + 1), \'top\': (sgControls.fullscreen.top) + \'px\'} : \'\'">\n\n        <div class="row" ng-hide="hide.all">\n\n            <div class="col-md-3">\n\n                <div ng-hide="hide.filter || hide.all">\n\n                    <label>Filtrar</label>\n                    <div class="input-group">\n                        <span class="input-group-addon" id="filtro-addon"><span class="fa fa-search"></span></span>\n                        <input type="text" class="form-control" ng-model="sg_filter" placeholder="Palavra-chave" aria-describedby="filtro-addon">\n                    </div>\n\n                </div>\n\n            </div>\n\n            <div class="col-md-2">\n\n                <div class="form-group" ng-hide="hide.linesPage || hide.all || hide.pagination" style="margin-bottom: 0;">\n\n                    <label>Linhas por página</label>\n\n                    <div class="input-group" style="width: 120px;">\n\n                        <span class="input-group-btn">\n                            <button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(-1)">-</button>\n                        </span>\n\n                        <input class="form-control" ng-model="sg_linesPerPageInput">\n\n                        <span class="input-group-btn">\n\t\t\t\t\t\t\t<button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(1)">+</button>\n\t\t\t\t\t\t</span>\n\n                    </div>\n\n                </div>\n\n            </div>\n\n            <div class="col-md-2">\n\n                <div ng-hide="hide.options || hide.all">\n\n                    <label>Opções</label>\n\n                    <div class="input-group">\n                        <input type="text" class="form-control" aria-label="..." value="{{data.length}} encontrado(s)" disabled="true">\n                        <div class="input-group-btn">\n                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-bars"></span></button>\n                            <ul class="dropdown-menu dropdown-menu-right">\n                                <li ng-repeat="item in sgMenu">\n                                    <a ng-click="item.function()"><span class="{{item.icon}}"></span> {{item.title}}</a>\n                                </li>\n                                <li role="separator" class="divider" ng-show="menu"></li>\n                                <li><a ng-click="softGridToExcel()"><span class="fa fa-file-excel-o"></span> Gerar Excel</a></li>\n                            </ul>\n                        </div>\n                    </div>\n\n                    <div ng-if="!subgrid">\n                    <a href="#" ng-show="false"  id="softDownload"></a>\n                    </div>\n\n                </div>\n\n            </div>\n\n            <div class="col-md-2">\n\n                <div ng-hide="hide.fullscreen || hide.all">\n\n                    <label>&nbsp;</label><br>\n                    <button class="btn btn-default" ng-click="softgrid.fullscreen = softgrid.fullscreen ? false : true"><span class="fa fa-expand" ng-class="{\'fa-compress\': softgrid.fullscreen}"></span>\n\n                        {{ softgrid.fullscreen ? (sgControls.fullscreen.on ? sgControls.fullscreen.on : \'Tela normal\') : (sgControls.fullscreen.off ? sgControls.fullscreen.off : \'Tela cheia\') }}\n\n                    </button>\n\n                </div>\n\n            </div>\n\n            <div class="col-md-3">\n\n                <nav aria-label="Page navigation" class="pull-right" ng-hide="hide.pagination || hide.all">\n\n                    <label>Paginação</label>\n\n                        <ul class="pagination">\n\n                            <li ng-repeat="soft_page in soft_pages" ng-class="{\'active\': soft_page.active}">\n                                <a ng-click="sg_changePage(soft_page.value)" ng-bind-html="soft_page.text"></a>\n                            </li>\n\n                        </ul>\n\n                </nav>\n\n            </div>\n\n        </div>\n\n    </div>\n\n    <div class="row">\n\n        <div class="col-md-12">\n\n                <div class="softgrid-container">\n\n                    <div ng-style=" width ? { \'width\': width + \'px\' } : { \'width\': \'100%\' }">\n\n                        <table ng-attr-id="{{!subgrid ? \'none\': \'softgrid\'}}" class="softgrid {{template}}" >\n\n                            <thead>\n\n                                <th ng-show="actions.length > 0 || subgrid">\n\n                                </th>\n\n\t\t\t\t\t\t\t\t<th ng-show="sgControls.create || sgControls.read || sgControls.update || sgControls.delete" style="text-align: center;">\n\t\t\t\t\t\t\t\t\tAções\n\t\t\t\t\t\t\t\t</th>\n\n                                <th ng-repeat="col in cols" ng-show="!col.hide" style="text-align:center;">\n\n                                  <span class="title" ng-click="sg_sort(col)">\n\n\t\t\t\t\t\t\t\t\t  {{col.title}}\n\n\t\t\t\t\t\t\t\t\t  <span ng-show="col === sg_orderByCol" class="fa fa-sort-amount-asc" ng-class="{\'fa-sort-amount-desc\' : reverse}"></span>\n\n\t\t\t\t\t\t\t\t  </span>\n\n                                </th>\n\n\t\t\t\t\t\t\t\t<th ng-show="sgControls.active" style="text-align: center;">\n\t\t\t\t\t\t\t\t\t{{sgControls.activeTitle}}\n\t\t\t\t\t\t\t\t</th>\n\n                            </thead>\n\n                            <tbody>\n\n                                <tr ng-init="$last ? sg_hook() : angular.noop()" ng-class="{\'soft-row-striped\': ($index%2)}" ng-repeat-start="row in (dataFiltered = (data | filter: sg_filter | limitTo: sg_linesPerPage : ((sg_currentPage * sg_linesPerPage) - sg_linesPerPage))) track by $index" ng-style="sgControls.changeRowColor(row) === true && {\'background-color\': (sgControls.rowColor ? sgControls.rowColor :\'#e59482\')}" >\n\n                                    <td ng-show="subgrid || actions.length > 0" style="text-align:center; width: {{larguraColunaAcoes}}px">\n\n                                                \x3c!-- botão para exibir sub tabela --\x3e\n                                                <button ng-show="subgrid" type="button" class="btn btn-default btn-sm btn-subgrid" ng-click="showSubGrid = showSubGrid ? false : true" style="float: left;">\n                                                    <span class="fa fa-expand" ng-class="{\'fa-compress\': showSubGrid}"></span>\n                                                </button>\n\n                                                <div class="dropdown">\n\n                                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                                                        <span class="fa fa-bars"></span>\n                                                    </button>\n\n                                                    <ul class="dropdown-menu dropdown-menu-left">\n                                                        <li ng-repeat="action in actions"><a ng-click="action.function(row)"><span class="{{action.icon}}"></span> {{action.title}}</a></li>\n                                                    </ul>\n\n                                                </div>\n\n                                    </td>\n\n\t\t\t\t\t\t\t\t\t\x3c!-- column to actions --\x3e\n\t\t\t\t\t\t\t\t\t<td ng-if="sgControls.create || sgControls.read || sgControls.update || sgControls.delete" style="text-align:center; width: {{larguraColunaControles}}px">\n\n\t\t\t\t\t\t\t\t\t\t<button ng-show="sgControls.create" type="button" class="btn btn-default btn-sm" ng-click="sgControls.create.action(row)" title="{{ sgControls.create.title ? sgControls.create.title : \'Criar\' }}">\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-plus"></span>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t<button ng-show="sgControls.read" type="button" class="btn btn-default btn-sm"   ng-click="sgControls.read.action(row)" title="{{ sgControls.read.title ? sgControls.read.title : \'Ver\' }}">\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-search"></span>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t<button ng-show="sgControls.update" type="button" class="btn btn-default btn-sm" ng-click="sgControls.update.action(row)" title="{{ sgControls.update.title ? sgControls.update.title : \'Atualizar\' }}">\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-pencil"></span>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t<button ng-show="sgControls.delete" type="button" class="btn btn-default btn-sm" ng-click="sgControls.delete.action(row)" title="{{ sgControls.delete.title ? sgControls.delete.title : \'Deletar\' }}">\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-trash"></span>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t</td>\n\n                                    \x3c!-- data columns--\x3e\n                                    <td ng-repeat="col in cols track by $index" ng-init="$parent.editing = false" class="opafion">\n\n                                        <input ng-show="editing" ng-init="newvalue = col.item(row)" class="edit-input" ng-model="newvalue" ng-blur="sg_edit(row, col, newvalue, this)" style="width: {{col.edit.width}};">\n\n                                        <div ng-show="!editing" ng-dblclick="sg_openEdit(this, $event)" ng-style="col.align ? { \'text-align\': col.align} : { \'text-align\': \'left\' }">\n\n                                            <label ng-hide="col.popOver" style="width: 100%;">\n\n                                                {{temp = sg_mask(col.type, (col.item(row) | limitTo: (col.maxLength ? col.maxLength : 999)))}}&nbsp;\n\n                                            </label>\n\n                                            <label style="text-decoration: underline; cursor: pointer" ng-show="col.popOver"   popover data-toggle="popover" data-trigger="hover" data-content="{{col.item(row)}}">{{(col.item(row) | limitTo: (col.maxLength ? col.maxLength : 999))}}</label>\n\n                                        </div>\n\n                                    </td>\n\n\t\t\t\t\t\t\t\t\t\x3c!-- Coluna para checkbox --\x3e\n\t\t\t\t\t\t\t\t\t<td style="text-align: center;" ng-show="sgControls.active">\n\t\t\t\t\t\t\t\t\t\t<label class="switch">\n\t\t\t\t\t\t\t\t\t\t\t<input type="checkbox" ng-checked="sgControls.activeCol(row)" ng-click="sgControls.activeFunction(row)">\n\t\t\t\t\t\t\t\t\t\t\t<div class="slider round"></div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</td>\n\n                                </tr>\n                                <tr ng-repeat-end="" ng-show="subgrid" ng-hide="!showSubGrid" ng-class="{\'soft-row-striped\': ($index%2)}"> \x3c!-- Linha para Subtabela --\x3e\n\n                                    <td colspan="{{cols.length + 3}}">\n\n                                        <div class="soft-subgrid-container">\n\n                                            <div ng-if="subgrid">\n\n                                                <softgrid  cols="subgrid.cols" actions="subgrid.actions" data="row[subgrid.object]" hide="subgrid.hide" template="\'soft-subgrid\'" sg-controls="subgrid.controls"></softgrid>\n\n                                            </div>\n\n                                        </div>\n\n                                    </td>\n\n                                </tr>\n\n                                \x3c!-- Exibe uma linha caso não haja dados --\x3e\n                                <tr ng-show="!data || data.length <= 0" style="text-align: center;">\n\n                                    <td colspan="{{cols.length + 3}} ">\n                                    Não há dados a serem exibidos.\n                                    </td>\n                                </tr>\n\n                            </tbody>\n\n                        </table>\n\n                    </div>\n\n                </div>\n\n        </div>\n\n    </div>\n\n    <div class="row" ng-hide="hide.pagination || hide.all">\n\n        <div class="col-md-12">\n\n            <nav aria-label="...">\n                <ul class="pager" style="margin-top: 5px;">\n                    <li class="previous"><button class="btn btn-default pull-left" ng-click="sg_changePage(-1)"><span aria-hidden="true">&larr;</span> Página anterior</button></li>\n                    <li class="next"><button class="btn btn-default pull-right" ng-click="sg_changePage(0)">Próxima página <span aria-hidden="true">&rarr;</span></button></li>\n                </ul>\n            </nav>\n\n        </div>\n\n    </div>\n\n</div>\n\n')}]);